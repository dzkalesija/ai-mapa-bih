<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nacionalno istraživanje o digitalnoj adaptaciji (AI) u BiH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { background-color: #0f172a; color: white; font-family: 'Inter', sans-serif; }
        .step { display: none; }
        .step.active { display: block; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .selected { border-color: #3b82f6 !important; background-color: rgba(59, 130, 246, 0.2); }
        input[type="range"]::-webkit-slider-thumb { border-radius: 50%; background: #3b82f6; cursor: pointer; }
    </style>
</head>
<body class="p-4 md:p-10 flex flex-col min-h-screen">

    <div class="max-w-3xl mx-auto bg-slate-800/40 p-8 rounded-3xl border border-slate-700 shadow-2xl flex-grow w-full">
        <div class="mb-10 border-b border-slate-700 pb-6 text-center">
            <h1 class="text-2xl font-extrabold text-blue-400 uppercase tracking-tighter italic">Istraživanje Digitalne Adaptacije</h1>
            <p class="text-slate-400 text-sm mt-2 font-medium">Socio-tehnološka studija o uticaju vještačke inteligencije u BiH</p>
        </div>

        <form id="aiSurvey">
            <div class="step active" id="step1">
                <h2 class="text-xl font-bold mb-6 flex items-center"><span class="bg-blue-600 w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm">1</span> Osnovni profil</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-[10px] font-bold text-slate-500 uppercase mb-2 tracking-widest text-center">Entitet / Distrikt</label>
                        <select id="entitet" onchange="azurirajOpcine()" class="w-full p-4 rounded-xl bg-slate-900 border border-slate-700 outline-none focus:ring-2 ring-blue-500 text-white">
                            <option value="">Odaberite...</option>
                            <option value="FBiH">Federacija BiH</option>
                            <option value="RS">Republika Srpska</option>
                            <option value="BD">Brčko Distrikt</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-slate-500 uppercase mb-2 tracking-widest text-center">Općina / Grad</label>
                        <select id="opcina" class="w-full p-4 rounded-xl bg-slate-900 border border-slate-700 outline-none focus:ring-2 ring-blue-500 text-white">
                            <option value="">Prvo odaberite entitet...</option>
                        </select>
                    </div>
                </div>
                
                <div class="mb-8">
                    <label class="block text-[10px] font-bold text-slate-500 uppercase mb-2 tracking-widest text-center">Profesionalni / Akademski status</label>
                    <select id="struka" onchange="pokaziPut()" class="w-full p-4 rounded-xl bg-slate-900 border border-slate-700 outline-none focus:ring-2 ring-blue-500 font-semibold text-blue-400">
                        <option value="">Odaberite ulogu...</option>
                        <option value="dr_sc">Doktor nauka / Profesor</option>
                        <option value="mr_sc">Magistar nauka / Istraživač</option>
                        <option value="student">Student (II i III ciklus)</option>
                        <option value="it_sektor">IT stručnjak / Inženjer</option>
                        <option value="biznis">Menadžment / Administracija</option>
                        <option value="javni_sektor">Javna uprava / Institucije</option>
                        <option value="proizvodnja">Industrija / Realni sektor</option>
                        <option value="ucenik_ss">Učenik (Srednja škola)</option>
                    </select>
                </div>
                <button type="button" onclick="nextStep(2)" class="w-full bg-blue-600 hover:bg-blue-500 p-4 rounded-2xl font-bold uppercase tracking-widest transition-all shadow-lg shadow-blue-900/20">Nastavi</button>
            </div>

            <div class="step" id="step2">
                <div id="dinamicki_sadrzaj"></div>
                <button type="button" onclick="nextStep(3)" class="w-full mt-8 bg-blue-600 p-4 rounded-2xl font-bold uppercase tracking-widest">Analiza faktora barijere</button>
            </div>

            <div class="step" id="step3">
                <h2 class="text-xl font-bold mb-6 flex items-center"><span class="bg-blue-600 w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm">3</span> Barijere i Alati</h2>
                
                <div class="mb-10 bg-slate-900/50 p-6 rounded-2xl border border-slate-700">
                    <label class="block text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest text-center italic">Nivo tehničke barijere / Nelagode pri uvođenju AI (1-5)</label>
                    <div class="flex justify-between px-2 mb-2">
                        <span class="text-[10px] text-emerald-400 uppercase font-bold">Spreman</span>
                        <span class="text-[10px] text-rose-500 uppercase font-bold">Otpor</span>
                    </div>
                    <input type="range" id="strah_nivo" min="1" max="5" value="1" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500">
                    <div class="text-center font-black text-blue-400 mt-3 text-xl"><span id="strah_val">1</span></div>
                </div>

                <div class="mb-10">
                    <label class="block text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest text-center">Očekivanje od budućnosti rada</label>
                    <div class="space-y-3">
                        <label class="block p-4 bg-slate-900 border border-slate-700 rounded-xl cursor-pointer hover:border-blue-500 transition-all text-sm">
                            <input type="radio" name="ocekivanje" value="Pozitivan" checked class="mr-3"> AI kao alat za novu produktivnost
                        </label>
                        <label class="block p-4 bg-slate-900 border border-slate-700 rounded-xl cursor-pointer hover:border-blue-500 transition-all text-sm">
                            <input type="radio" name="ocekivanje" value="Negativan" class="mr-3"> AI kao prijetnja trenutnoj ulozi
                        </label>
                    </div>
                </div>

                <div class="mb-8">
                    <label class="block text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest text-center">Alati koje aktivno istražujete / koristite</label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2" id="alati_grid"></div>
                </div>

                <div class="mb-8">
                    <label class="block text-[10px] font-bold text-slate-500 uppercase mb-2 tracking-widest text-center italic text-blue-400">Procijenjena ušteda vremena po Vašem mišljenju</label>
                    <select id="usteda_procent" class="w-full p-4 rounded-xl bg-slate-900 border border-slate-700 outline-none text-center font-bold">
                        <option value="5">Do 5% (Marginalno)</option>
                        <option value="15">5% - 20% (Vidljivo)</option>
                        <option value="35">20% - 50% (Transformacijski)</option>
                        <option value="60">Preko 50% (Potpuna promjena)</option>
                    </select>
                </div>

                <button type="button" id="submitBtn" onclick="submitData()" class="w-full bg-emerald-600 hover:bg-emerald-500 p-5 rounded-2xl font-black uppercase tracking-widest transition-all shadow-xl">Pošalji podatke i izračunaj IDA</button>
            </div>

            <div class="step text-center" id="step4">
                <div class="w-20 h-20 bg-blue-600/20 rounded-full flex items-center justify-center mx-auto mb-6">
                    <span class="text-4xl italic font-black">IDA</span>
                </div>
                <h1 class="text-3xl font-bold mb-2 uppercase">Indeks Adaptacije</h1>
                <div class="text-7xl font-black text-blue-500 mb-8" id="iq_score">0</div>
                <div class="p-6 bg-slate-900 rounded-2xl border border-slate-700 text-left">
                    <p id="hvala_msg" class="text-sm leading-relaxed text-slate-300 italic"></p>
                </div>
                <button type="button" onclick="location.reload()" class="mt-8 text-slate-500 text-xs hover:text-white uppercase tracking-widest underline">Novi unos</button>
            </div>
        </form>
    </div>

    <footer class="mt-10 text-center text-[9px] text-slate-600 uppercase tracking-[0.4em] pb-10">
        <p>Istraživački projekat: <span class="text-slate-400 font-bold underline">NACIONALNI AI MONITOR BiH</span></p>
    </footer>

    <script>
        const opcineBiH = {
            "FBiH": ["Banovići", "Bihać", "Bosanska Krupa", "Bosanski Petrovac", "Bosansko Grahovo", "Breza", "Bugojno", "Busovača", "Bužim", "Cazin", "Čapljina", "Čelić", "Čitluk", "Drvar", "Doboj Istok", "Doboj Jug", "Dobretići", "Domaljevac-Šamac", "Donji Vakuf", "Foča-Ustikolina", "Fojnica", "Glamoč", "Goražde", "Gornji Vakuf-Uskoplje", "Gračanica", "Gradačac", "Grude", "Hadžići", "Ilijaš", "Jablanica", "Jajce", "Kakanj", "Kalesija", "Kiseljak", "Kladanj", "Ključ", "Konjic", "Kupres", "Livno", "Ljubuški", "Lukavac", "Maglaj", "Mostar", "Neum", "Novi Travnik", "Odžak", "Olovo", "Orašje", "Pale-Prača", "Posušje", "Prozor-Rama", "Ravno", "Sanski Most", "Sapna", "Sarajevo-Centar", "Sarajevo-Novi Grad", "Sarajevo-Novo Sarajevo", "Sarajevo-Stari Grad", "Stolac", "Srebrenik", "Tešanj", "Tomislavgrad", "Travnik", "Trnovo", "Tuzla", "Usora", "Vareš", "Velika Kladuša", "Visoko", "Vitez", "Vogošća", "Zavidovići", "Zenica", "Žepče", "Živinice"],
            "RS": ["Banja Luka", "Berkovići", "Bijeljina", "Bileća", "Bratunac", "Brod", "Čajniče", "Čelinac", "Derventa", "Doboj", "Donji Žabar", "Foča", "Gacko", "Gradiška", "Han Pijesak", "Istočna Ilidža", "Istočni Drvar", "Istočni Mostar", "Istočni Stari Grad", "Istočno Novo Sarajevo", "Jezero", "Kalinovik", "Kneževo", "Kostajnica", "Kotor Varoš", "Kozarska Dubica", "Krupa na Uni", "Kupres", "Laktaši", "Lopare", "Ljubinje", "Milići", "Modriča", "Mrkonjić Grad", "Nevesinje", "Novi Grad", "Novo Goražde", "Osmaci", "Oštra Luka", "Pale", "Pelagićevo", "Petrovac", "Petrovo", "Prijedor", "Prnjavor", "Ribnik", "Rogatica", "Rudo", "Sokolac", "Srbac", "Srebrenica", "Stanari", "Šamac", "Šekovići", "Šipovo", "Teslić", "Trebinje", "Trnovo", "Ugljevik", "Višegrad", "Vlasenica", "Vukosavlje", "Zvornik"],
            "BD": ["Brčko Distrikt"]
        };

        function azurirajOpcine() {
            const entitet = document.getElementById('entitet').value;
            const sel = document.getElementById('opcina');
            sel.innerHTML = '<option value="">Odaberite...</option>';
            if(entitet && opcineBiH[entitet]) {
                opcineBiH[entitet].sort().forEach(o => sel.innerHTML += `<option value="${o}">${o}</option>`);
            }
        }

        const alati = ["ChatGPT", "DeepSeek", "Claude AI", "Gemini", "Midjourney", "DALL-E", "GitHub Copilot", "Cursor", "Canva AI", "Perplexity", "ElevenLabs", "Sora"];
        let odabraniAlati = [];
        const grid = document.getElementById('alati_grid');

        alati.forEach(a => {
            const div = document.createElement('div');
            div.className = "p-2 bg-slate-900 border border-slate-700 rounded-xl text-[10px] text-center cursor-pointer hover:border-blue-500 transition-all font-bold";
            div.innerText = a;
            div.onclick = function() {
                this.classList.toggle('selected');
                if(odabraniAlati.includes(a)) odabraniAlati = odabraniAlati.filter(i => i !== a);
                else odabraniAlati.push(a);
            };
            grid.appendChild(div);
        });

        document.getElementById('strah_nivo').oninput = function() { document.getElementById('strah_val').innerText = this.value; }

        function pokaziPut() {
            const struka = document.getElementById('struka').value;
            const kont = document.getElementById('dinamicki_sadrzaj');
            kont.innerHTML = '';
            let opcije = [];

            if(struka === 'dr_sc' || struka === 'mr_sc') opcije = ["Akademsko istraživanje", "Statistička analiza", "Pisanje radova", "Mentorstvo"];
            else if(struka === 'student') opcije = ["Pomoć pri učenju", "Izrada projekata", "Prevod literature", "Coding"];
            else if(struka === 'biznis' || struka === 'javni_sektor') opcije = ["Izvještaji i dopisi", "Analiza podataka", "Marketing", "Administracija"];
            else if(struka === 'it_sektor') opcije = ["Generisanje koda", "Debugiranje", "Dokumentacija", "Arhitektura"];
            else opcije = ["Opšta produktivnost", "Pretraga informacija", "Kreativni rad"];

            kont.innerHTML = `<h2 class="text-xl font-bold mb-6 flex items-center"><span class="bg-blue-600 w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm">2</span> Specifična primjena</h2>`;
            opcije.forEach(o => {
                kont.innerHTML += `<label class="block p-4 bg-slate-900 border border-slate-700 rounded-2xl mb-3 cursor-pointer hover:bg-slate-800 transition-all text-sm font-medium"><input type="checkbox" name="spec" value="${o}" class="mr-3"> ${o}</label>`;
            });
        }

        function nextStep(s) {
            if(s === 2 && !document.getElementById('struka').value) { alert("Molimo odaberite profil."); return; }
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.getElementById('step' + s).classList.add('active');
            window.scrollTo(0,0);
        }

        async function submitData() {
            // ANTI-DUPLIKAT ZAŠTITA
            if(localStorage.getItem('anketa_sent')) {
                alert("Sistem je detektovao da ste već popunili anketu. Hvala na učešću!");
                return;
            }

            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.innerText = "Slanje podataka...";

            const strah = parseInt(document.getElementById('strah_nivo').value);
            const usteda = parseInt(document.getElementById('usteda_procent').value);
            const ocekivanje = document.querySelector('input[name="ocekivanje"]:checked').value;
            
            // IDA INDEX (0-100)
            let ida = 35 + (usteda * 0.6) + (odabraniAlati.length * 4) - (strah * 5);
            ida = Math.min(Math.max(ida, 0), 100);

            const data = {
                entitet: document.getElementById('entitet').value,
                opcina: document.getElementById('opcina').value,
                struka: document.getElementById('struka').options[document.getElementById('struka').selectedIndex].text,
                specificni_odgovori: Array.from(document.querySelectorAll('input[name="spec"]:checked')).map(e => e.value).join(', '),
                alati: odabraniAlati.join(', '),
                ustedjeno_vrijeme: usteda,
                uticaj_na_posao: ocekivanje,
                ai_iq_score: ida.toFixed(0)
            };

            try {
                const res = await fetch('https://ai-mapa-bih-1.onrender.com/submit-survey', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                
                if(res.ok) {
                    localStorage.setItem('anketa_sent', 'true');
                    document.getElementById('iq_score').innerText = ida.toFixed(0);
                    document.getElementById('hvala_msg').innerText = `Kao ${data.struka} iz općine ${data.opcina}, pomogli ste u definisanju digitalne mape BiH. Vaš doprinos je anoniman i dragocjen.`;
                    nextStep(4);
                } else {
                    throw new Error("Greška na serveru");
                }
            } catch (e) {
                alert("Greška: Server nije odgovorio na vrijeme. Pokušajte ponovo za 10 sekundi.");
                btn.disabled = false;
                btn.innerText = "Pokušaj ponovo";
            }
        }
    </script>
</body>
</html>