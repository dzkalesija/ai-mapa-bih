<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Monitor BiH | Nacionalna Platforma</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Inter:wght@200;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #020617; --primary: #3b82f6; --accent: #10b981; }
        body { background-color: var(--bg); color: #f1f5f9; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .mono { font-family: 'Space Mono', monospace; }
        .step { display: none; }
        .step.active { display: block; animation: fadeIn 0.6s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.05); }
        .terminal-text { border-right: 2px solid var(--primary); white-space: nowrap; overflow: hidden; }
        .btn-glow:hover { box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
        select { cursor: pointer; }
        .card-opt { border: 1px solid rgba(255,255,255,0.05); transition: 0.3s; background: rgba(30, 41, 59, 0.4); }
        .selected { border-color: var(--primary) !important; background: rgba(59, 130, 246, 0.1) !important; color: var(--primary); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="intro-screen" class="fixed inset-0 z-50 bg-slate-950 flex items-center justify-center p-6">
        <div class="max-w-2xl w-full mono">
            <div id="terminal" class="text-blue-400 text-sm md:text-base leading-relaxed"></div>
            <button id="start-btn" onclick="startSurvey()" class="hidden mt-10 px-8 py-4 border border-blue-500 text-blue-500 hover:bg-blue-500 hover:text-white transition-all uppercase tracking-[0.3em] text-xs">Pokreni Analizu</button>
        </div>
    </div>

    <div class="max-w-4xl w-full glass p-8 md:p-12 rounded-[2.5rem] shadow-2xl relative z-10">
        <form id="monitorForm">
            <div class="step active" id="step1">
                <div class="text-center mb-12">
                    <h2 class="text-[10px] uppercase tracking-[0.5em] text-blue-500 mb-2">Identifikacija Izvora</h2>
                    <h1 class="text-2xl font-light">Geografska i Sektorska Pripadnost</h1>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="text-[9px] uppercase text-slate-500 block mb-2 ml-2">Regija / Entitet</label>
                        <select id="entitet" onchange="fillOpcine()" class="w-full bg-slate-900 border border-slate-800 p-4 rounded-2xl text-sm outline-none focus:border-blue-500 transition-all">
                            <option value="">Odaberi...</option>
                            <option value="FBiH">Federacija BiH</option>
                            <option value="RS">Republika Srpska</option>
                            <option value="BD">Brčko Distrikt</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-[9px] uppercase text-slate-500 block mb-2 ml-2">Općina / Grad</label>
                        <select id="opcina" class="w-full bg-slate-900 border border-slate-800 p-4 rounded-2xl text-sm outline-none">
                            <option value="">Prvo odaberi regiju...</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
                    <div>
                        <label class="text-[9px] uppercase text-slate-500 block mb-2 ml-2">Sektor djelovanja</label>
                        <select id="sektor" onchange="updateSubSectors()" class="w-full bg-slate-900 border border-slate-800 p-4 rounded-2xl text-sm text-blue-300 outline-none">
                            <option value="">Odaberi sektor...</option>
                            <option value="obrazovanje">Obrazovanje i Nauka</option>
                            <option value="privreda">Privreda i Industrija</option>
                            <option value="javni">Javni sektor i Zdravstvo</option>
                            <option value="kreativa">IT i Kreativna industrija</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-[9px] uppercase text-slate-500 block mb-2 ml-2">Specifična oblast</label>
                        <select id="pod_sektor" onchange="checkBtn1()" class="w-full bg-slate-900 border border-slate-800 p-4 rounded-2xl text-sm text-emerald-400 outline-none">
                            <option value="">Čekanje na sektor...</option>
                        </select>
                    </div>
                </div>
                <button type="button" id="btn1" onclick="next(2)" disabled class="w-full bg-blue-600/20 p-6 rounded-2xl text-[10px] uppercase tracking-[0.3em] transition-all opacity-50 cursor-not-allowed btn-glow">Nastavi na evaluaciju</button>
            </div>

            <div class="step" id="step2">
                <div class="text-center mb-10">
                    <h2 id="naslov_oblasti" class="text-emerald-400 uppercase text-[10px] tracking-widest italic"></h2>
                </div>
                <div id="pitanja_container" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10"></div>
                <button type="button" onclick="next(3)" class="w-full bg-blue-600/40 p-5 rounded-xl text-[10px] uppercase tracking-widest">Sledeće: Alati</button>
            </div>

            <div class="step" id="step3">
                <div id="alati_grid" class="grid grid-cols-2 md:grid-cols-5 gap-3 mb-10"></div>
                <div class="max-w-md mx-auto text-center mb-12">
                    <label class="text-[9px] uppercase text-slate-500 block mb-6">Procijenjena ušteda vremena putem AI</label>
                    <input type="range" id="usteda" min="0" max="100" value="15" class="w-full h-1 bg-slate-800 appearance-none accent-blue-500" oninput="uVal.innerText=this.value+'%'">
                    <div id="uVal" class="mt-4 text-2xl font-thin text-blue-400">15%</div>
                </div>
                <button type="button" onclick="posalji()" class="w-full bg-blue-600 p-7 rounded-[2rem] text-[11px] uppercase font-bold tracking-[0.4em] btn-glow transition-all">Kalkuliši IDA Index</button>
            </div>

            <div class="step text-center" id="step4">
                <div class="py-20">
                    <p class="text-[10px] text-slate-500 uppercase tracking-[0.5em] mb-6">Index Digitalne Adaptacije</p>
                    <h1 id="score_val" class="text-[9rem] md:text-[12rem] font-thin text-blue-500 leading-none">0</h1>
                    <div class="mt-12">
                        <button type="button" onclick="location.reload()" class="text-slate-600 hover:text-white text-[10px] uppercase border-b border-slate-800 pb-2 transition-all">Novi unos u bazu</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <script>
        // --- DATA: SVE OPĆINE BiH ---
        const opcineBiH = {
            "FBiH": ["Banovići", "Bihać", "Bosanska Krupa", "Bosanski Petrovac", "Bosansko Grahovo", "Breza", "Bugojno", "Busovača", "Bužim", "Cazin", "Čapljina", "Čelić", "Čitluk", "Doboj Istok", "Doboj Jug", "Dobretići", "Domaljevac-Šamac", "Donji Vakuf", "Drvar", "Foča-Ustikolina", "Fojnica", "Glamoč", "Goražde", "Gornji Vakuf-Uskoplje", "Gračanica", "Gradačac", "Grude", "Hadžići", "Ilijaš", "Jablanica", "Jajce", "Kakanj", "Kalesija", "Kiseljak", "Kladanj", "Ključ", "Konjic", "Kreševo", "Kupres", "Livno", "Ljubuški", "Lukavac", "Maglaj", "Mostar", "Neum", "Novi Travnik", "Odžak", "Olovo", "Orašje", "Pale-Prača", "Posušje", "Prozor-Rama", "Ravno", "Sanski Most", "Sapna", "Sarajevo-Centar", "Sarajevo-Novi Grad", "Sarajevo-Novo Sarajevo", "Sarajevo-Stari Grad", "Srebrenik", "Stolac", "Tešanj", "Tomislavgrad", "Travnik", "Trnovo", "Tuzla", "Usora", "Vareš", "Velika Kladuša", "Visoko", "Vitez", "Vogošća", "Zavidovići", "Zenica", "Žepče", "Živinice"],
            "RS": ["Banja Luka", "Berkovići", "Bijeljina", "Bileća", "Kostajnica", "Brod", "Bratunac", "Čajniče", "Čelinac", "Derventa", "Doboj", "Donji Žabar", "Foča", "Gacko", "Gradiška", "Han Pijesak", "Istočna Ilidža", "Istočni Drvar", "Istočni Mostar", "Istočni Stari Grad", "Istočno Novo Sarajevo", "Jezero", "Kalinovik", "Kneževo", "Kotor Varoš", "Kozarska Dubica", "Krupa na Uni", "Kupres", "Laktaši", "Lopare", "Ljubinje", "Milići", "Modriča", "Mrkonjić Grad", "Nevesinje", "Novi Grad", "Novo Goražde", "Osmaci", "Oštra Luka", "Pale", "Pelagićevo", "Petrovac", "Petrovo", "Prijedor", "Prnjavor", "Ribnik", "Rogatica", "Rudo", "Sokolac", "Srbac", "Srebrenica", "Stanari", "Šamac", "Šekovići", "Šipovo", "Teslić", "Trebinje", "Trnovo", "Ugljevik", "Višegrad", "Vlasenica", "Vukosavlje", "Zvornik"],
            "BD": ["Brčko Distrikt"]
        };

        const sektorskaMapa = {
            "obrazovanje": [
                {id:"os", name:"Osnovno obrazovanje", q:["AI Asistencija u nastavi", "Interaktivno učenje", "Personalizovani planovi"]},
                {id:"ss", name:"Srednje obrazovanje", q:["Analiza literature", "Pomoć pri kodiranju", "Priprema državne mature"]},
                {id:"ak", name:"Visoko obrazovanje / Akademija", q:["Naučno istraživanje", "Statistička obrada", "Akademsko pisanje"]}
            ],
            "privreda": [
                {id:"ind", name:"Industrija / Proizvodnja", q:["Prediktivno održavanje", "Optimizacija procesa", "Kontrola kvaliteta"]},
                {id:"agr", name:"Poljoprivreda", q:["Analiza zemljišta", "Satelitsko praćenje", "Pametno navodnjavanje"]},
                {id:"usl", name:"Uslužne djelatnosti", q:["Chatbot podrška", "Analiza tržišta", "Automatizacija bookinga"]}
            ],
            "javni": [
                {id:"adm", name:"Javna uprava / Administracija", q:["Digitalizacija arhiva", "Automatizacija rješenja", "Servisi za građane"]},
                {id:"med", name:"Medicina / Zdravstvo", q:["Radiološka analiza", "Trijaža pacijenata", "Medicinska dokumentacija"]}
            ],
            "kreativa": [
                {id:"it", name:"IT / Software Development", q:["Debugiranje koda", "Arhitektura sistema", "Automatizovano testiranje"]},
                {id:"mkt", name:"Marketing i Dizajn", q:["Generisanje vizuala", "Copywriting", "Video produkcija"]}
            ]
        };

        const alatiList = ["ChatGPT", "Claude", "Gemini", "DeepSeek", "Midjourney", "Perplexity", "Copilot", "Canva", "ElevenLabs", "Sora"];

        // --- INTRO ANIMACIJA ---
        const introText = [
            "> INICIJALIZACIJA SISTEMA...",
            "> POVEZIVANJE SA NACIONALNOM BAZOM BiH...",
            "> UČITAVANJE ALGORITAMA ZA IZRAČUN IDA INDEXA...",
            "> SPREMNO ZA EVALUACIJU DIGITALNE ZRELOSTI.",
            "> DOBRODOŠLI U AI MONITOR BiH."
        ];

        let line = 0;
        function typeIntro() {
            if (line < introText.length) {
                let div = document.createElement('div');
                div.className = "mb-2";
                div.innerHTML = introText[line];
                document.getElementById('terminal').appendChild(div);
                line++;
                setTimeout(typeIntro, 800);
            } else {
                document.getElementById('start-btn').classList.remove('hidden');
            }
        }
        window.onload = typeIntro;

        function startSurvey() {
            document.getElementById('intro-screen').style.display = 'none';
        }

        // --- LOGIKA FORME ---
        function fillOpcine() {
            const e = document.getElementById('entitet').value;
            const o = document.getElementById('opcina');
            o.innerHTML = '<option value="">Odaberi grad/općinu...</option>';
            if(e) opcineBiH[e].sort((a,b) => a.localeCompare(b, 'bs')).forEach(x => {
                o.innerHTML += `<option value="${x}">${x}</option>`;
            });
        }

        function updateSubSectors() {
            const s = document.getElementById('sektor').value;
            const ps = document.getElementById('pod_sektor');
            ps.innerHTML = '<option value="">Odaberi oblast...</option>';
            if(s) sektorskaMapa[s].forEach(x => {
                ps.innerHTML += `<option value="${x.id}">${x.name}</option>`;
            });
        }

        function checkBtn1() {
            const btn = document.getElementById('btn1');
            if(document.getElementById('pod_sektor').value && document.getElementById('opcina').value) {
                btn.disabled = false; btn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        function next(s) {
            if(s === 2) {
                const sVal = document.getElementById('sektor').value;
                const psVal = document.getElementById('pod_sektor').value;
                const oblast = sektorskaMapa[sVal].find(x => x.id === psVal);
                document.getElementById('naslov_oblasti').innerText = "Analiza oblasti: " + oblast.name;
                const container = document.getElementById('pitanja_container');
                container.innerHTML = '';
                oblast.q.forEach(q => {
                    const d = document.createElement('div');
                    d.className = "card-opt p-5 rounded-2xl text-[10px] uppercase text-center flex items-center justify-center min-h-[80px]";
                    d.innerHTML = `<input type="checkbox" name="odgovor" value="${q}" class="hidden">${q}`;
                    d.onclick = function() {
                        const cb = this.querySelector('input');
                        cb.checked = !cb.checked;
                        this.classList.toggle('selected', cb.checked);
                    };
                    container.appendChild(d);
                });
            }
            if(s === 3 && document.getElementById('alati_grid').innerHTML === '') {
                alatiList.forEach(a => {
                    const d = document.createElement('div');
                    d.className = "card-opt p-4 rounded-xl text-[9px] text-center uppercase tracking-tighter";
                    d.innerText = a;
                    d.onclick = function() { this.classList.toggle('selected'); };
                    document.getElementById('alati_grid').appendChild(d);
                });
            }
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.getElementById('step' + s).classList.add('active');
        }

        async function posalji() {
            const selectedAlati = Array.from(document.querySelectorAll('#alati_grid .selected')).map(x => x.innerText);
            const selectedOdgovori = Array.from(document.querySelectorAll('input[name="odgovor"]:checked')).map(x => x.value);
            const usteda = parseInt(document.getElementById('usteda').value);
            
            let score = (35 + (selectedOdgovori.length * 9) + (selectedAlati.length * 4) + (usteda * 0.2)).toFixed(1);
            score = Math.min(score, 100);

            const data = {
                entitet: document.getElementById('entitet').value,
                opcina: document.getElementById('opcina').value,
                sektor: document.getElementById('sektor').options[document.getElementById('sektor').selectedIndex].text,
                pod_sektor: document.getElementById('pod_sektor').options[document.getElementById('pod_sektor').selectedIndex].text,
                odgovori: selectedOdgovori.join(", ") || "Nema specifične primjene",
                alati: selectedAlati.join(", ") || "Bez alata",
                usteda: usteda,
                stav: "Pozitivan",
                score: parseFloat(score)
            };

            document.getElementById('score_val').innerText = score;
            next(4);

            await fetch('https://ai-mapa-bih-1.onrender.com/submit-survey', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });
        }
    </script>
</body>
</html>